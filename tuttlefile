file://depts2015.txt <- http://www.insee.fr/fr/methodes/nomenclatures/cog/telechargement/2015/txt/depts2015.txt ! download

file://data/fr-departements.tsv <- file://depts2015.txt ! python
	import os
	import os.path
	if not os.path.isdir('data'):
		os.mkdir('data')
	columns = ['departement_id', 'departement_name', 'type_article', 'region', 'chef_lieu']
	with open('data/fr-departements.tsv', 'w') as fout, \
		 open('depts2015.txt') as fin :
		fout.write("\t".join(columns))
		fout.write("\n")
		next(fin) # pass the header
		for line in fin:
			region, dep, cheflieu, tncc, ncc, nccenr = line.strip().split("\t")
			fields = [dep, nccenr, tncc, region, cheflieu]
			fout.write("\t".join(fields))
			fout.write("\n")

			
file://reg2015.txt <- http://www.insee.fr/fr/methodes/nomenclatures/cog/telechargement/2015/txt/reg2015.txt ! download

file://data/fr-regions.tsv <- file://reg2015.txt ! python
	import os
	import os.path
	if not os.path.isdir('data'):
		os.mkdir('data')
	columns = ['region_id', 'region_name', 'type_article', 'chef_lieu']
	with open('data/fr-regions.tsv', 'w') as fout, \
		 open('reg2015.txt') as fin :
		fout.write("\t".join(columns))
		fout.write("\n")
		next(fin) # pass the header
		for line in fin:
			region, cheflieu, tncc, ncc, nccenr = line.strip().split("\t")
			fields = [region, nccenr, tncc, cheflieu]
			fout.write("\t".join(fields))
			fout.write("\n")
